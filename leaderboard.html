<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>I Migliori Punteggi – Quiz sul Calcio</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>I Migliori Punteggi</h1>
    <nav>
      <a href="index.html">Gioca</a>
      <a href="leaderboard.html" class="active">I Migliori Punteggi</a>
    </nav>
  </header>

  <main>
    <section class="card">
      <p>I migliori 5 punteggi:</p>
      <div id="leaderboard-wrapper" class="loading">
        <table class="table" id="leaderboard-table >
          <thead>
            <tr>
              <th>#</th>
              <th>Data</th>
              <th>Giocatore</th>
              <th>Punteggio</th>
            </tr>
          </thead>
          <tbody id="leaderboard-body">
          </tbody>
        </table>
      </div>  
      <div class="actions">
        <a class="secondary" href="index.html">Torna al gioco</a>
      </div>
    </section>
  </main>

  <footer>
    <small>Punteggi realizzati secondo le domande disponibili alla data indicata </small>
  </footer>

<script>
  console.log('1) Dopo tabella — tbody:', document.getElementById('leaderboard-body'));
</script>

  <script>
    // Sostituisci con l'URL /exec della tua Web App Apps Script
    const API_URL = 'https://script.google.com/macros/s/AKfycbx1HdH-ItpI553s6uHVOed4oqEDFy2v2yB7dfBV4-DE7bIE2z5jG3ABcXDsKrOvxZoR/exec';
    
     window.onLeaderboardData = function(resp) {
      const top5 = (data.top || []).slice(0, 5);
      const tbody = document.getElementById('leaderboard-body');
      console.log('2_ In callback — tbody:', tbody);
      if (!tbody) { console.error('tbody non trovato'); return; }
      tbody.innerHTML = '';
      top5.forEach((item, idx) => {
        const dateStr = new Date(item.date).toLocaleDateString('it-IT', { day:'2-digit', month:'2-digit', year:'numeric' });
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${idx+1}</td><td>${dateStr}</td><td>${item.name.slice(0, 10)}</td><td>${item.score}</td>`;
        tbody.appendChild(tr);
      });
      // tolgo il loading
      wrapper.classList.remove('loading');
    }

    function loadLeaderboardJSONP() {
      const s = document.createElement('script');
      const wrapper = document.getElementById('leaderboard-wrapper');
      wrapper.classList.add('loading');
      console.log('3) Prima di JSONP: inietto script…');
      s.src = `${API_URL}?callback=onLeaderboardData&_=${Date.now()}`;
      s.onerror = () => console.error('Errore nel caricamento dei punteggi');
      document.body.appendChild(s);
    }
     
   

    loadLeaderboardJSONP();
  </script>
</body>
</html>
